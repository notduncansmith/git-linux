var Lookout={models:{},init:function(e){Lookout.beforeWatch=e.beforeWatch||function(){};Lookout.afterWatch=e.afterWatch||function(){};Lookout.beforeUpdate=e.beforeUpdate||function(){};Lookout.afterUpdate=e.afterUpdate||function(){};e.collections.forEach(function(t,n){for(var r=e.collections[n].length-1;r>=0;r--){var i=e.collections[n][r];Lookout.models[i.id]=i;Lookout.beforeWatch(i);Lookout.watch(i);Lookout.afterWatch(i)}})},watch:function(e){var t="",n=Object.getOwnPropertyNames(e);for(var r=n.length-1;r>=0;r--){t+="input[data-"+e.id+"='"+n[r]+"'],";t+="select[data-"+e.id+"='"+n[r]+"'],";t+="textarea[data-"+e.id+"='"+n[r]+"'],"}t=t.substring(0,t.length-1);$(t).map(function(t,n){$(this).val(Lookout.models[e.id][$(this).data(e.id)]);var r=e,i=$(this).data(e.id),s=$(this).val();Lookout.beforeUpdate(r,i,s);Lookout.update(r,i,s);Lookout.afterUpdate(r,i,s)});if(options.onKeyUp){$(t).keyup(function(){var t=e,n=$(this).data(e.id),r=$(this).val();Lookout.beforeUpdate(t,n,r);Lookout.update(t,n,r);Lookout.afterUpdate(t,n,r)})}else{$(t).change(function(){var t=e,n=$(this).data(e.id),r=$(this).val();Lookout.beforeUpdate(t,n,r);Lookout.update(t,n,r);Lookout.afterUpdate(t,n,r)})}},update:function(e,t,n){Lookout.models[e.id][t]=n;var r="[data-"+e.id+"='"+t+"']";$(r).map(function(t,n){if(!$(n).data("view")){$(n).data("view",$(n).html())}var r=Mustache.render($(this).data("view"),Lookout.models[e.id]);$(n).html(r)})}}